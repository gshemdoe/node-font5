<div class="tgBody ddhide" id="tgBodyDSTG">
    <h2 class="kd">DRAMA STORE BOT</h2>
    <div class="logo-oh">
        <i class="fa-solid fa-file-video"></i>
    </div>
    <div class="caption">
        <h4 id="episode">EPISODE <span id="ep"></span> <br><br> ðŸ‘‡ðŸ‘‡</h4>
    </div>
    <div class="button">
        <button id="realDSTG"><b>OPEN IN TELEGRAM APP <i
                    class="fa-solid fa-arrow-up-right-from-square"></i></b></button>
        <button class="wait" id="waitBDSTG">WAITING - <span id="waitDSTG">00</span> sec</button>
        <p id="maelz" style="font-size: smaller;"><i>âš  click above to get the file.... In the bot click "START"</i>
        </p>

        <div class="dstweb tweb">
            <a id="dstweb" href="#" target="_blank">OPEN IN TELEGRAM WEB</a>
            <p style="font-size: smaller;"><i>âš  click above if the first link don't work</i> </p>
        </div>
    </div>
</div>

<script>
    function showingHide() {
        let hash = window.location.hash

        if (hash.includes('#getting-episode')) {
            let msgid = hash.split('dramaid=')[1].split('&')[0]
            let size = hash.split('&size=')[1].split('&')[0]
            let epno = hash.split('&epno=')[1]

            let realBtn = document.getElementById('realDSTG')
            let dsWeb = document.getElementById('dstweb')
            let dsWebClass = document.querySelector('.dstweb')

            if (size.includes('NAN')) {
                let uid = hash.split('&epno=')[1] // replace with userid
                dsWebClass.style.display = 'none'
                document.getElementById('maelz').style.display = 'none'
                document.getElementById('episode').innerHTML = 'FULL EPISODE WITH ENG SUB <br><br> ðŸ‘‡ðŸ‘‡'
                realBtn.innerText = 'REQUEST EPISODE'
                realBtn.setAttribute('onclick', `window.open("/req/${uid}/${msgid}", "_self")`)

            } else {
                realBtn.setAttribute('onclick', `openTgDS('${msgid}', '${epno}', '${size}')`)
                dsWeb.setAttribute('href', `https://t.me/dramastorebot?start=fromWeb${msgid}`)
                document.getElementById('ep').innerText = `${epno} (${size} MB)`
            }

            let waitSpan = document.getElementById('waitDSTG')
            let fakeBtn = document.getElementById('waitBDSTG')
            let count = 10
            let interval = setInterval(() => {
                count--
                waitSpan.innerText = count

                if (count == 0) {
                    clearInterval(interval)
                    fakeBtn.style.display = 'none'
                    realBtn.style.display = 'block'
                    if (!size.includes('NAN')) {
                        document.querySelector('.dstweb').style.display = 'flex'
                    }
                }
            }, 1200)
        }
    }
    showingHide()

    function openTgDS(msgid, epno, size) {
        window.open(`tg://resolve?domain=dramastorebot&start=fromWeb${msgid}`)
    }
</script>